# Test for libclang 4.0 python bindings
This relates to issue [niosus/EasyClangComplete#214](https://github.com/niosus/EasyClangComplete/issues/214).

There is an error when creating an `Index` with default cindex.py from libclang
4.0 bindings:
```
Traceback (most recent call last):
  File "script.py", line 33, in <module>
    index = cindex.Index.create()
  File "/home/igor/.config/sublime-text-3/Packages/clang-test-plugin/clang/cindex40_old.py", line 2427, in create
    return Index(conf.lib.clang_createIndex(excludeDecls, 0))
  File "/home/igor/.config/sublime-text-3/Packages/clang-test-plugin/clang/cindex40_old.py", line 2180, in __init__
    assert isinstance(obj, c_object_p) and obj
AssertionError
Exception ignored in: <bound method Index.__del__ of <clang.cindex40_old.Index object at 0x7f2f4d3564e0>>
Traceback (most recent call last):
  File "/home/igor/.config/sublime-text-3/Packages/clang-test-plugin/clang/cindex40_old.py", line 2430, in __del__
    conf.lib.clang_disposeIndex(self)
ctypes.ArgumentError: argument 1: <class 'TypeError'>: Don't know how to convert parameter 1

```

# Run it from command line
- navigate to the folder where you have cloned it
- run `script.py` with your version of python:
  + Power Shell: `PS C:\Users\<user>\AppData\Roaming\Sublime Text 3\Packages\test-complete-plugin> python.exe .\script.py`
  + terminal: `python <path_to_instalation>/sctipt.py`
- you can pass a single parameter to the script with the full path to your
  `clang++` binary. This way you can control which libclang library will be
  used.

# Current state
There are two versions of bindings: [cindex40_old.py](clang/cindex40_old.py)
and [cindex40_new.py](clang/cindex40_new.py).

The old ones generate the error, while the new ones work as expected. There are
also bindings from an older version of libclang: `cindex38.py`, they also work.

The working version `cindex40_new.py` is generated by encorporating the changes
using a diff of `cindex38.py -> cindex40_old.py`.
